<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>class UART – duplex serial communication bus</title>
    
      <link rel="stylesheet" href="../../_static/pygments.css">
      <link rel="stylesheet" href="../../_static/theme.css">
      <link rel="stylesheet" href="../../_static/override.css">
      

      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="class SPI – a Serial Peripheral Interface bus protocol (master side)" href="machine.SPI.html" />
  <link rel="prev" title="class ADC – analog to digital conversion" href="machine.ADC.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><div class="navbar" @toggle-sidebar="toggleSidebar">
    <div class="home-link-container">
        <router-link to="../../index.html" class="home-link">
        
          <span class="site-name">CodeBug Connect</span>
      </router-link>
    </div>
  
    <div class="links">
      <div class="can-hide">



      </div>
    </div>
  </div>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <div class="sidebar" @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
    <div class="caption"><span class="caption-text">Search</span>
      <div class="searchformwrapper">
        <form autocomplete="off" class="search" action="../../search.html" method="get">
          <input type="text" name="q" autocomplete="off" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
    </div>
  </div><div class="sidebar-links" role="navigation" aria-label="main navigation">
    
        <div class="sidebar-group">
        <p class="caption">
            <span class="caption-text"><a href="../../index.html#welcome-to-codebug-connect-s-documentation">Contents:</a></span>
        </p>
        <ul class="">
            
            <li class="toctree-l1 "><a href="../../gettingstarted/quickstart.html" class="reference internal ">Quickstart</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../gettingstarted/setup_wifi.html" class="reference internal ">Setting Up WiFi</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../gettingstarted/onboardide.html" class="reference internal ">On-board IDE</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../gettingstarted/remotedeployment.html" class="reference internal ">Remote Deployment</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../gettingstarted/samples.html" class="reference internal ">Sample Code</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../gettingstarted/updating.html" class="reference internal ">Updating CodeBug</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../detail/connection_modes.html" class="reference internal ">Connection Modes</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../../detail/boot.html" class="reference internal ">Boot process</a>

                
            </li>

            
            <li class="toctree-l1 "><a href="../modules.html" class="reference internal ">Programming Reference</a>

                
            </li>

            
        </ul>
        </div>
    
</div>
        </div>

      <div class="page">
          <div class="body-header" role="navigation" aria-label="navigation">
    
    <ul class="breadcrumbs">
      <li><a href="../../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../modules.html">Programming Reference</a> &raquo;</li>
      
        <li><a href="index.html">MicroPython libraries</a> &raquo;</li>
      
        <li><a href="machine.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">machine</span></code> — functions related to the hardware</a> &raquo;</li>
      
      <li>class UART – duplex serial communication bus</li>
    </ul>
    
  
    <ul class="page-nav">
      <li class="prev">
        <a href="machine.ADC.html"
           title="previous chapter">← class ADC – analog to digital conversion</a>
      </li>
      <li class="next">
        <a href="machine.SPI.html"
           title="next chapter">class SPI – a Serial Peripheral Interface bus protocol (master side) →</a>
      </li>
    </ul>
    
  </div>
  <hr>
          <div class="content" role="main">
            
  <div class="section" id="class-uart-duplex-serial-communication-bus">
<span id="machine-uart"></span><h1>class UART – duplex serial communication bus<a class="headerlink" href="#class-uart-duplex-serial-communication-bus" title="Permalink to this headline">¶</a></h1>
<p>UART implements the standard UART/USART duplex serial communications protocol.  At
the physical level it consists of 2 lines: RX and TX.  The unit of communication
is a character (not to be confused with a string character) which can be 8 or 9
bits wide.</p>
<p>UART objects can be created and initialised using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">UART</span>

<span class="n">uart</span> <span class="o">=</span> <span class="n">UART</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>                         <span class="c1"># init with given baudrate</span>
<span class="n">uart</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mi">9600</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">parity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># init with given parameters</span>
</pre></div>
</div>
<p>Supported parameters differ on a board:</p>
<p>Pyboard: Bits can be 7, 8 or 9. Stop can be 1 or 2. With <em>parity=None</em>,
only 8 and 9 bits are supported.  With parity enabled, only 7 and 8 bits
are supported.</p>
<p>WiPy/CC3200: Bits can be 5, 6, 7, 8. Stop can be 1 or 2.</p>
<p>A UART object acts like a <cite>stream</cite> object and reading and writing is done
using the standard stream methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uart</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>       <span class="c1"># read 10 characters, returns a bytes object</span>
<span class="n">uart</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>         <span class="c1"># read all available characters</span>
<span class="n">uart</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>     <span class="c1"># read a line</span>
<span class="n">uart</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>  <span class="c1"># read and store into the given buffer</span>
<span class="n">uart</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>   <span class="c1"># write the 3 characters</span>
</pre></div>
</div>
<div class="section" id="constructors">
<h2>Constructors<a class="headerlink" href="#constructors" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="machine.UART">
<em class="property">class </em><code class="sig-prename descclassname">machine.</code><code class="sig-name descname">UART</code><span class="sig-paren">(</span><em class="sig-param">id</em>, <em class="sig-param">...</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a UART object of the given id.</p>
</dd></dl>

</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="py method">
<dt id="machine.UART.init">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">baudrate=9600</em>, <em class="sig-param">bits=8</em>, <em class="sig-param">parity=None</em>, <em class="sig-param">stop=1</em>, <em class="sig-param">*</em>, <em class="sig-param">...</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the UART bus with the given parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>baudrate</em> is the clock rate.</p></li>
<li><p><em>bits</em> is the number of bits per character, 7, 8 or 9.</p></li>
<li><p><em>parity</em> is the parity, <code class="docutils literal notranslate"><span class="pre">None</span></code>, 0 (even) or 1 (odd).</p></li>
<li><p><em>stop</em> is the number of stop bits, 1 or 2.</p></li>
</ul>
</div></blockquote>
<p>Additional keyword-only parameters that may be supported by a port are:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>tx</em> specifies the TX pin to use.</p></li>
<li><p><em>rx</em> specifies the RX pin to use.</p></li>
<li><p><em>txbuf</em> specifies the length in characters of the TX buffer.</p></li>
<li><p><em>rxbuf</em> specifies the length in characters of the RX buffer.</p></li>
<li><p><em>timeout</em> specifies the time to wait for the first character (in ms).</p></li>
<li><p><em>timeout_char</em> specifies the time to wait between characters (in ms).</p></li>
<li><p><em>invert</em> specifies which lines to invert.</p></li>
</ul>
</div></blockquote>
<p>On the WiPy only the following keyword-only parameter is supported:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>pins</em> is a 4 or 2 item list indicating the TX, RX, RTS and CTS pins (in that order).
Any of the pins can be None if one wants the UART to operate with limited functionality.
If the RTS pin is given the the RX pin must be given as well. The same applies to CTS.
When no pins are given, then the default set of TX and RX pins is taken, and hardware
flow control will be disabled. If <em>pins</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, no pin assignment will be made.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.deinit">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">deinit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.deinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn off the UART bus.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.any">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">any</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.any" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer counting the number of characters that can be read without
blocking.  It will return 0 if there are no characters available and a positive
number if there are characters.  The method may return 1 even if there is more
than one character available for reading.</p>
<p>For more sophisticated querying of available characters use select.poll:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">poll</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="n">poll</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">uart</span><span class="p">,</span> <span class="n">select</span><span class="o">.</span><span class="n">POLLIN</span><span class="p">)</span>
<span class="n">poll</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.read">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param">nbytes</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read characters.  If <code class="docutils literal notranslate"><span class="pre">nbytes</span></code> is specified then read at most that many bytes,
otherwise read as much data as possible. It may return sooner if a timeout
is reached. The timeout is configurable in the constructor.</p>
<p>Return value: a bytes object containing the bytes read in.  Returns <code class="docutils literal notranslate"><span class="pre">None</span></code>
on timeout.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.readinto">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">readinto</code><span class="sig-paren">(</span><em class="sig-param">buf</em><span class="optional">[</span>, <em class="sig-param">nbytes</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.readinto" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bytes into the <code class="docutils literal notranslate"><span class="pre">buf</span></code>.  If <code class="docutils literal notranslate"><span class="pre">nbytes</span></code> is specified then read at most
that many bytes.  Otherwise, read at most <code class="docutils literal notranslate"><span class="pre">len(buf)</span></code> bytes. It may return sooner if a timeout
is reached. The timeout is configurable in the constructor.</p>
<p>Return value: number of bytes read and stored into <code class="docutils literal notranslate"><span class="pre">buf</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> on
timeout.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.readline">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">readline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.readline" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a line, ending in a newline character. It may return sooner if a timeout
is reached. The timeout is configurable in the constructor.</p>
<p>Return value: the line read or <code class="docutils literal notranslate"><span class="pre">None</span></code> on timeout.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.write">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">buf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the buffer of bytes to the bus.</p>
<p>Return value: number of bytes written or <code class="docutils literal notranslate"><span class="pre">None</span></code> on timeout.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.sendbreak">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">sendbreak</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.sendbreak" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a break condition on the bus. This drives the bus low for a duration
longer than required for a normal transmission of a character.</p>
</dd></dl>

<dl class="py method">
<dt id="machine.UART.irq">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">irq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trigger</span></em>, <em class="sig-param"><span class="n">priority</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">handler</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wake</span><span class="o">=</span><span class="default_value">machine.IDLE</span></em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.irq" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a callback to be triggered when data is received on the UART.</p>
<blockquote>
<div><ul class="simple">
<li><p><em>trigger</em> can only be <code class="docutils literal notranslate"><span class="pre">UART.RX_ANY</span></code></p></li>
<li><p><em>priority</em> level of the interrupt. Can take values in the range 1-7.
Higher values represent higher priorities.</p></li>
<li><p><em>handler</em> an optional function to be called when new characters arrive.</p></li>
<li><p><em>wake</em> can only be <code class="docutils literal notranslate"><span class="pre">machine.IDLE</span></code>.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The handler will be called whenever any of the following two conditions are met:</p>
<blockquote>
<div><ul class="simple">
<li><p>8 new characters have been received.</p></li>
<li><p>At least 1 new character is waiting in the Rx buffer and the Rx line has been
silent for the duration of 1 complete frame.</p></li>
</ul>
</div></blockquote>
<p>This means that when the handler function is called there will be between 1 to 8
characters waiting.</p>
</div>
<p>Returns an irq object.</p>
<p>Availability: WiPy.</p>
</dd></dl>

</div>
<div class="section" id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h2>
<dl class="py data">
<dt id="machine.UART.RX_ANY">
<code class="sig-prename descclassname">UART.</code><code class="sig-name descname">RX_ANY</code><a class="headerlink" href="#machine.UART.RX_ANY" title="Permalink to this definition">¶</a></dt>
<dd><p>IRQ trigger sources</p>
<p>Availability: WiPy.</p>
</dd></dl>

</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
      <li class="prev">
        <a href="machine.ADC.html"
           title="previous chapter">← class ADC – analog to digital conversion</a>
      </li>
      <li class="next">
        <a href="machine.SPI.html"
           title="next chapter">class SPI – a Serial Peripheral Interface bus protocol (master side) →</a>
      </li>
    </ul><div class="footer" role="contentinfo">
        &#169; Copyright 2020, OpenLX SP Ltd.
      <br>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1 with <a href="https://github.com/romnnn/sphinx_press_theme">Press Theme</a>.
  </div>
            </div>
          </div>
      </div>
    </div>
    
    
  </body>
</html>